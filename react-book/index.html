<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <div class="wrapper">
        <!-- <button class="like-btn">
            <span class="like-text">
                ç‚¹èµ
            </span>
            <span class="like-icon">ğŸ‘</span>
        </button> -->
    </div>
    <script>
        // const button = document.querySelector('.like-btn');
        // const buttonText = button.querySelector('.like-text');
        // const buttonIcon = button.querySelector('.like-icon')
        // let isLiked = false;
        // button.addEventListener('click',() => {
        //     console.log('---')
        //      isLiked = !isLiked;
        //     if(isLiked){
        //         buttonText.innerHTML = 'å–æ¶ˆ'
        //     } else {
        //         buttonText.innerHTML = 'ç‚¹èµ'
        //     }
        // })

        // wapper æŒ‚è½½ç‚¹ mount åˆ° æ ¹èŠ‚ç‚¹ä¸Š
        const wrapper = document.querySelector('.wrapper')
        // String -> DOM
        const createDOMFromString = (domString) => {
            // DOM æ¯”htmlString å¥½çš„åœ°æ–¹åœ¨äº js æ“ä½œ
            const div = document.createElement('div');
            div.innerHTML = domString;
            return div;
        }
        class LikeButton {
            constructor() {
                this.state = {
                    isLiked: false
                }
            }
            changeLikeText() {
                console.log(this.el)
                // const likeText = this.el.querySelector('.like-text')
                // this.state.isLiked = !this.state.isLiked
                // likeText.innerHTML = this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'
                // ä»¥ä¸Šæœ‰å¤ªå¤šçš„DOM äº†
                // æ²¡æœ‰DOM
                this.setState({
                    isLiked: !this.state.isLiked
                })
            }
            setState(state){
                //å°†çŠ¶æ€è·Ÿæ–°
                // VM æ¨¡å‹ this.state View è§†å›¾çš„å®æ—¶å¯¹åº”
                const oldEl = this.el
                this.state = state;
                this.el = this.render();
                // DOMæ›´æ–°
                if(this.onStateChange(oldEl,this.el)){

                }

            }
            
            // render ç›¸å½“äºä¹‹å‰çš„ dom template å¿…å¤‡çš„æ–¹æ³•
            render() {
                this.el = createDOMFromString(`
                <button class="like-btn">
                    <span class="like-text">${this.state.isLiked ? 'å–æ¶ˆ' : 'ç¡®å®š'}</span>
                </button>
                `)
                this.el.addEventListener('click', this.changeLikeText.bind(this), false);
                return this.el;
            }
        }
        const LikeButton1 = new LikeButton()
        // console.log(wrapper)
        // wrapper.innerHTML = LikeButton1.render()
        wrapper.appendChild(LikeButton1.render())

        LikeButton1.onStateChange = (oldEl,newEl) => {
            wrapper.insertBefore(newEl,oldEl);
            wrapper.removeChild(oldEl)
        }

        const LikeButton2 = new LikeButton()
        wrapper.appendChild(LikeButton2.render())

    </script>
</body>

</html>